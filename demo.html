<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Install Bridge — Interactive Demo</title>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea, #764ba2);
      min-height: 100vh;
      padding: 24px;
    }

    .container {
      max-width: 1200px;
      margin: auto;
    }

    header {
      text-align: center;
      color: white;
      margin-bottom: 48px;
    }

    h1 {
      font-size: 48px;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .tagline {
      opacity: 0.9;
      font-size: 18px;
    }

    .demo-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
    }

    @media (max-width: 768px) {
      .demo-grid { grid-template-columns: 1fr; }
    }

    .panel {
      background: white;
      border-radius: 14px;
      padding: 32px;
      box-shadow: 0 12px 40px rgba(0,0,0,0.2);
    }

    h2 {
      font-size: 22px;
      margin-bottom: 16px;
      color: #222;
    }

    textarea {
      width: 100%;
      height: 380px;
      font-family: "Monaco", monospace;
      font-size: 13px;
      border: 2px solid #e1e4e8;
      border-radius: 8px;
      padding: 16px;
      resize: vertical;
    }

    .btn-group {
      display: flex;
      gap: 12px;
      margin-top: 16px;
    }

    .btn {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .btn:hover {
      background: #5568d3;
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(102,126,234,0.4);
    }

    .badge-preview {
      background: #f6f8fa;
      border-radius: 10px;
      padding: 48px;
      text-align: center;
      margin-bottom: 20px;
    }

    .snippet {
      background: #f6f8fa;
      padding: 14px;
      border-radius: 8px;
      font-family: "Monaco", monospace;
      font-size: 12px;
      word-break: break-all;
      margin-top: 8px;
    }

    .label {
      font-weight: 600;
      margin-top: 18px;
      display: block;
      color: #555;
    }

    .success, .error {
      margin-top: 16px;
      padding: 14px;
      border-radius: 8px;
      font-weight: 500;
    }

    .success {
      background: #f0fff4;
      border: 2px solid #9ae6b4;
      color: #276749;
    }

    .error {
      background: #fff5f5;
      border: 2px solid #feb2b2;
      color: #9b2c2c;
    }

    .info {
      background: #ebf8ff;
      border-left: 4px solid #667eea;
      padding: 16px;
      border-radius: 6px;
      font-size: 14px;
    }

    .full {
      grid-column: 1 / -1;
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <h1>Install Bridge</h1>
      <p class="tagline">A neutral bridge between repositories and installers</p>
    </header>

    <div class="demo-grid">

      <!-- CONFIG -->
      <div class="panel">
        <h2>1 · Define install intent</h2>
        <textarea id="config">
{
  "name": "MyAwesomeApp",
  "installers": {
    "darwin": "https://example.com/app-mac.dmg",
    "linux": "https://example.com/app-linux.AppImage",
    "win32": "https://example.com/app-windows.exe"
  },
  "homepage": "https://myapp.dev"
}
        </textarea>

        <div class="btn-group">
          <button class="btn" onclick="generate()">Generate</button>
          <button class="btn" onclick="validate()">Validate</button>
        </div>

        <div id="result"></div>
      </div>

      <!-- PREVIEW -->
      <div class="panel">
        <h2>2 · Install surface</h2>

        <div class="badge-preview" id="preview">
          <span style="color:#999">Badge renders here</span>
        </div>

        <div class="info">
          Click the badge. In production, Install Bridge detects OS and routes to the correct installer.
        </div>

        <span class="label">Markdown</span>
        <div class="snippet" id="md">—</div>

        <span class="label">HTML</span>
        <div class="snippet" id="html">—</div>
      </div>

      <!-- EXPLANATION -->
      <div class="panel full">
        <h2>How this maps to Install Bridge</h2>
        <p>
          This demo mirrors the real architecture:
          a small declarative config, pure logic for badge generation,
          and a thin install surface that can run locally or on the edge.
        </p>
      </div>

    </div>
  </div>

  <script>
    const Core = {
      validate(cfg) {
        const errors = [];
        if (!cfg?.name) errors.push("Missing app name");
        if (!cfg?.installers || !Object.keys(cfg.installers).length)
          errors.push("At least one installer required");
        return errors;
      },

      badge(cfg) {
        return `
<svg xmlns="http://www.w3.org/2000/svg" width="180" height="36">
  <rect rx="6" width="180" height="36" fill="#111"/>
  <text x="90" y="23" fill="#fff" font-size="14" text-anchor="middle"
        font-family="Arial, Helvetica, sans-serif">
    Install ${cfg.name}
  </text>
</svg>`;
      }
    };

    function validate() {
      try {
        const cfg = JSON.parse(config.value);
        const errors = Core.validate(cfg);
        result.innerHTML = errors.length
          ? `<div class="error">${errors.join("<br>")}</div>`
          : `<div class="success">Configuration valid</div>`;
      } catch (e) {
        result.innerHTML = `<div class="error">${e.message}</div>`;
      }
    }

    function generate() {
      try {
        const cfg = JSON.parse(config.value);
        const errors = Core.validate(cfg);
        if (errors.length) return validate();

        const svg = Core.badge(cfg);
        const url = URL.createObjectURL(new Blob([svg], { type: "image/svg+xml" }));
        const install = cfg.homepage || Object.values(cfg.installers)[0];

        preview.innerHTML = `<a href="${install}" target="_blank">
          <img src="${url}" />
        </a>`;

        md.textContent = `[![Install ${cfg.name}](install-badge.svg)](${install})`;
        html.textContent =
`<a href="${install}">
  <img src="install-badge.svg" alt="Install ${cfg.name}">
</a>`;

        result.innerHTML = `<div class="success">Badge generated</div>`;
      } catch (e) {
        result.innerHTML = `<div class="error">${e.message}</div>`;
      }
    }

    generate();
  </script>
</body>
</html>
